{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 304, "length": 333, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableBank", "source_mapping": {"start": 57, "length": 582, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}, {"type": "node", "name": "(success) = msg.sender.call{value: amount}()", "source_mapping": {"start": 497, "length": 53, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [17], "starting_column": 9, "ending_column": 62}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 304, "length": 333, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableBank", "source_mapping": {"start": 57, "length": 582, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "balances[msg.sender] = 0", "source_mapping": {"start": 606, "length": 24, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [20], "starting_column": 9, "ending_column": 33}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 304, "length": 333, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableBank", "source_mapping": {"start": 57, "length": 582, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "balances"}}], "description": "Reentrancy in VulnerableBank.withdraw() (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#12-21):\n\tExternal calls:\n\t- (success) = msg.sender.call{value: amount}() (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#17)\n\tState variables written after the call(s):\n\t- balances[msg.sender] = 0 (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#20)\n\tVulnerableBank.balances (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#5) can be used in cross function reentrancies:\n\t- VulnerableBank.balances (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#5)\n\t- VulnerableBank.deposit() (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#7-10)\n\t- VulnerableBank.withdraw() (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#12-21)\n", "markdown": "Reentrancy in [VulnerableBank.withdraw()](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L12-L21):\n\tExternal calls:\n\t- [(success) = msg.sender.call{value: amount}()](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L17)\n\tState variables written after the call(s):\n\t- [balances[msg.sender] = 0](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L20)\n\t[VulnerableBank.balances](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L5) can be used in cross function reentrancies:\n\t- [VulnerableBank.balances](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L5)\n\t- [VulnerableBank.deposit()](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L7-L10)\n\t- [VulnerableBank.withdraw()](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L12-L21)\n", "first_markdown_element": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L12-L21", "id": "63067bd61c9fe26ec6487dbd3a8cfc973c03971fdd93ba36e6367f9ee6614cf3", "check": "reentrancy-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "pragma", "name": "^0.8.0", "source_mapping": {"start": 32, "length": 23, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [2], "starting_column": 1, "ending_column": 24}, "type_specific_fields": {"directive": ["solidity", "^", "0.8", ".0"]}}], "description": "Pragma version^0.8.0 (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#2) allows old versions\n", "markdown": "Pragma version[^0.8.0](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L2) allows old versions\n", "first_markdown_element": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L2", "id": "33a7b17721ae235829437130b158c5cf5b40d1f5e8360737a02333ea840d88db", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [], "description": "solc-0.8.0 is not recommended for deployment\n", "markdown": "solc-0.8.0 is not recommended for deployment\n", "first_markdown_element": "", "id": "c298e4718eba1e635e63e4c3206d561ac1974eaef1a3bba154ff9c56bcf6282a", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 304, "length": 333, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableBank", "source_mapping": {"start": 57, "length": 582, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}, {"type": "node", "name": "(success) = msg.sender.call{value: amount}()", "source_mapping": {"start": 497, "length": 53, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [17], "starting_column": 9, "ending_column": 62}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 304, "length": 333, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableBank", "source_mapping": {"start": 57, "length": 582, "filename_relative": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_absolute": "/tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "filename_short": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}}}], "description": "Low level call in VulnerableBank.withdraw() (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#12-21):\n\t- (success) = msg.sender.call{value: amount}() (../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#17)\n", "markdown": "Low level call in [VulnerableBank.withdraw()](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L12-L21):\n\t- [(success) = msg.sender.call{value: amount}()](../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L17)\n", "first_markdown_element": "../../../../../../tmp/2ddfe466-7b84-4292-a76d-8e20778e8a23/vulnerablebank/VulnerableBank.sol#L12-L21", "id": "2238d5e19a77371c801ea8eccf7c8359e45641a4f88b2ee3b0fc78e27aee22c6", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}]}}
